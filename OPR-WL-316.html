<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>서부내륙고속도로 통합운영단말</title>
  <link rel="stylesheet" href="css/common.css">
  <link rel="stylesheet" type="text/css" href="https://cdn.rawgit.com/ax5ui/ax5ui-grid/master/dist/ax5grid.css">
  <script src="js/jquery.min.js"></script>
  <script src="js/tui-time-picker.js"></script>
  <script src="js/tui-date-picker.js"></script>
  <script src="js/jquery-ui.min.js"></script>
  <script src="js/jquery.magnific-popup.min.js"></script>
  <script src="js/swiper-bundle.min.js"></script>
  <script src="js/aos.js"></script>
  <script type="text/javascript" src="https://cdn.rawgit.com/ax5ui/ax5core/master/dist/ax5core.min.js"></script>
  <script type="text/javascript" src="https://cdn.rawgit.com/ax5ui/ax5ui-grid/master/dist/ax5grid.min.js"></script>
  <script src="js/ui.js"></script>
</head>
<body>
  <div id="wrap" class="c-scrollbar">
    <div id="header">
      <h1><a href="#"><img src="img/wih-logo-io.png" alt=""></a></h1>
      <div class="item-area">
        <ul id="gnb" data-active="9">
          <li><a href="#">시스템관리</a></li>
          <li><a href="#">기초정보관리</a></li>
          <li><a href="#">FTMS 제어</a></li>
          <li><a href="#">운영관리</a></li>
          <li><a href="#">상황관리</a></li>
          <li><a href="#">모니터링</a></li>
          <li><a href="#">이력조회</a></li>
          <li><a href="#">통계조회</a></li>
          <li><a href="#">현장장비 점검관리</a></li>
          <li><a href="#">안전관리</a></li>
          <li><a href="#">작업 및 유지보수 이력 관리</a></li>
        </ul>
        <ul id="utilmenu">
          <li><a href="#" class="s-ico notify w-label new"><span>고윤정님</span></a></li>
          <li><a href="#" class="s-ico bookmark"></a></li>
          <li><a href="#" class="s-ico logout"></a></li>
        </ul>
        <div class="bookmark-area">
          <ul>
            <li>
              <a href="#">
                <span class="s-ico star on"></span>
                <span class="label">즐겨찾기</span>
              </a>
            </li>
            <li>
              <a href="#">
                <span class="s-ico star on"></span>
                <span class="label">즐겨찾기</span>
              </a>
            </li>
            <li>
              <a href="#">
                <span class="s-ico star on"></span>
                <span class="label">즐겨찾기</span>
              </a>
            </li>
            <li>
              <a href="#">
                <span class="s-ico star on"></span>
                <span class="label">즐겨찾기</span>
              </a>
            </li>
            <li>
              <a href="#">
                <span class="s-ico star on"></span>
                <span class="label">즐겨찾기</span>
              </a>
            </li>
            <li>
              <a href="#">
                <span class="s-ico star on"></span>
                <span class="label">즐겨찾기</span>
              </a>
            </li>
            <li>
              <a href="#">
                <span class="s-ico star on"></span>
                <span class="label">즐겨찾기</span>
              </a>
            </li>
            <li>
              <a href="#">
                <span class="s-ico star on"></span>
                <span class="label">즐겨찾기</span>
              </a>
            </li>
            <li>
              <a href="#">
                <span class="s-ico star on"></span>
                <span class="label">RWIS 제어기 기초정보관리</span>
              </a>
            </li>
            <li>
              <a href="#">
                <span class="s-ico star on"></span>
                <span class="label">즐겨찾기 최대 10개</span>
              </a>
            </li>
          </ul>
          <div class="bookmark-item">
            <a href="#" class="btn-text">즐겨찾기 관리 <span class="s-ico arrow"></span></a>
            <a href="#" class="s-ico close gray"></a>
          </div>
        </div><!-- .bookmark-area -->
      </div>
    </div><!--#header -->
    <div id="container" class="ver-lnb">
      <div class="left-wrap">
        <h3 class="tit">현장장비 점검관리</h3>
        <ul class="lnb-list">
          <li class="on">
            <a href="#" class="menu toggle">FTMS 점검계획</a>
            <ul>
              <li class="on">
                <a href="#" class="menu">점검 계획</a>
                <a href="#" class="s-ico star"></a>
              </li>
              <li>
                <a href="#" class="menu">FTMS 점검 체크리스트 관리</a>
                <a href="#" class="s-ico star"></a>
              </li>
            </ul>
          </li>
          <li>
            <a href="#" class="menu toggle">FTMS 점검 일지 관리</a>
            <ul>
              <li>
                <a href="#" class="menu">FTMS 점검 일지 관리</a>
                <a href="#" class="s-ico star"></a>
              </li>
            </ul>
          </li>
          <li>
            <a href="#" class="menu toggle">고장 및 수리 관리</a>
            <ul>
              <li>
                <a href="#" class="menu">서브 메뉴</a>
                <a href="#" class="s-ico star"></a>
              </li>
            </ul>
          </li>
          <li>
            <a href="#" class="menu">점검 항목 관리</a>
            <a href="#" class="s-ico star"></a>
          </li>
          <li>
            <a href="#" class="menu toggle">보고서</a>
            <ul>
              <li>
                <a href="#" class="menu">서브 메뉴</a>
                <a href="#" class="s-ico star"></a>
              </li>
            </ul>
          </li>
          <li>
            <a href="#" class="menu toggle">센터설비 점검 체크리스트</a>
            <ul>
              <li>
                <a href="#" class="menu">서브 메뉴</a>
                <a href="#" class="s-ico star"></a>
              </li>
            </ul>
          </li>
        </ul>
      </div><!-- .left-wrap -->
      <div class="content-wrap auto-height">
        <div class="content-top">
          <div class="menu-area">
            <a href="#" class="s-ico home"></a>
            <div class="menu-swiper swiper-container">
              <div class="swiper-wrapper">
                <div class="swiper-slide on">
                  <a href="#" class="label">FTMS 점검 일지 관리</a>
                  <a href="#" class="s-ico close"></a>
                </div>
              </div>
            </div>
          </div>
          <div class="navi-area">
            <a href="" class="s-ico arrow-l"></a>
            <a href="" class="s-ico arrow-r"></a>
          </div>
        </div><!-- .content-top -->
        <div class="content-area">
          <div class="content-inner">
            <div class="search-area">
              <ul class="tab-btn">
                <li class="on"><a href="#">현장설비</a></li>
                <li><a href="#">센터설비</a></li>
              </ul>
              <div class="btns-wrap">
                <span class="btn-base btn-ico"><a href="#"><em><span class="s-ico plan"></span>계획출력</em></a></span>
                <span class="btn-base btn-ico btn-popup-anim-3"><a href="#popup-legend-1"><em><span class="s-ico color"></span>색상범례</em></a></span>
              </div>
            </div><!-- .search-area -->
            <div class="content-frame">
              <div class="calendar-item">
                <ul class="tab-btn">
                  <li class="on"><a href="#">월간</a></li>
                  <li><a href="#">주간</a></li>
                </ul>
              </div>
              <div id="calendar" class="monthGrid"></div>
            </div><!-- .content-frame -->
          </div><!-- .content-inner -->
        </div><!-- .content-area -->
      </div><!-- .content-wrap -->
    </div><!-- #container -->

    <div class="calendar-tooltip">
      <ul>
        <li><a href="#">스케줄 상세보기</a></li>
        <li><a href="#">스케줄 수정</a></li>
        <li><a href="#">스케줄 삭제</a></li>
      </ul>
    </div>

    <div class="popup-wrap mfp-hide" id="popup-legend-1" style="width: 384px;">
      <div class="con-wrap">
        <h3 class="tit">현장설비 색상 범례</h3>
        <ul class="legend-list">
          <li class="c-00bbfe">VDS</li>
          <li class="c-2f78ff">LCS</li>
          <li class="c-e3c208">VMS</li>
          <li class="c-853cfc">라디오 재방송</li>
          <li class="c-00be9c">CCTV</li>
          <li class="c-0bbe35">휴게소 주차정보</li>
          <li class="c-ef4345">긴급 전화</li>
          <li class="c-a89b8f">안개경고주의</li>
          <li class="c-ad2ec6">RWIS</li>
          <li class="c-d83a73">갱구부 LED</li>
        </ul>
        <div class="btns-wrap center mt24">
          <span class="btn-base gray b-mfp-close"><a href="#">닫기</a></span>
        </div>
      </div>
    </div><!-- .popup-wrap -->

    <div class="popup-wrap mfp-hide" id="popup-legend-2" style="width: 384px;">
      <div class="con-wrap">
        <h3 class="tit">센터설비 색상 범례</h3>
        <ul class="legend-list">
          <li class="c-00bbfe">중앙호스트</li>
          <li class="c-2f78ff">운영단말</li>
          <li class="c-e3c208">상황판</li>
          <li class="c-853cfc">백업장치</li>
          <li class="c-ef4345">긴급전화 센터설비</li>
          <li class="c-00be9c">CCTV 중앙장비</li>
          <li class="c-0bbe35">부대설비</li>
          <li class="c-d83a73">주변장치</li>
        </ul>
        <div class="btns-wrap center mt24">
          <span class="btn-base gray b-mfp-close"><a href="#">닫기</a></span>
        </div>
      </div>
    </div><!-- .popup-wrap -->
  </div><!-- #wrap -->
  
  <script src="js/fullCalendar.js"></script>
  <script src="js/calendarData.js"></script>
  <script>
    // 달력 DOCS(EVENT) - https://fullcalendar.io/docs/event-object
    var _showTip = false;
    var _timerTip = null;
    var fullCalendar = null;

    var drawTotalUI = function(){
      $('.fc-daygrid-day-bottom .total-num').remove(); // 이전, 다음달 클릭 시 초기화
      if (!$('#calendar.fc').hasClass('timeGrid')) {
        $('#calendar.fc .fc-daygrid-day').each(function () {
          $(this).find('.fc-daygrid-day-number').text($(this).find('.fc-daygrid-day-number').text().split('일')[0]);          
        });
      } else {
        $('#calendar.fc .fc-view-harness').css('height', $('#calendar.fc .fc-daygrid-body').outerHeight());
      }
    }

    document.addEventListener('DOMContentLoaded', function() {
      var calendarEl = document.getElementById('calendar');

      fullCalendar = new FullCalendar.Calendar(calendarEl, {
        headerToolbar: {
          left: null,
          center: 'prev title next',
          right: null,
        },
        initialDate: '2024-07-01',
        locale: 'ko',
        editable: true, // Drag 이벤트 비활성화
        dayMaxEvents: 3,
        events: regularData,
        // eventOrder: function(a, b) {
        //   return b.title.localeCompare(a.title);
        // },
        eventOrder: 'start',
        eventClick: function(info){
          clearTimeout(_timerTip);
          _showTip = false;

          // if ($(info.el).closest('.fc-scroller-liquid-absolute').length && $(info.el).closest('.weekGrid').length) {}
          console.log(info)
          $('.calendar-tooltip').css({
            left: info.jsEvent.x, // clientX, pageX, x
            top: info.jsEvent.y + 10, // clientY, pageY, y
            display: 'block',
          });
          
          _timerTip = setTimeout(() => {
            _showTip = true;
          }, 250);
        },
        
        datesSet: function() {
          setTimeout(function(){
            drawTotalUI();
          }, 10)
        },

        eventContent: function(arg) {
          var event = arg.event;
          var arr = event.title.split('|');
          var startTime = event.start;
          var endTime = event.end;
          const _startTime = String(startTime).match(/\b\d{2}:\d{2}/);
          const _endTime = String(endTime).match(/\b\d{2}:\d{2}/);
          if (_startTime[0] != "00:00") {
            if (_endTime?.[0]) {
              return {
                html: `<div class="fc-event-title fc-period">
                  <span class="fc-l">
                    <em class="date">${_startTime[0]} ~ ${_endTime?.[0]}</em>
                    <em class="title">${arr[0]}</em>
                  </span>
                  <span class="fc-r">${arr[1]}</span>
                </div>`
              }
            } else {
              return {
                html: `<div class="fc-event-title fc-oneway">
                  <span class="fc-l">
                    <em class="date">${_startTime[0]}</em>
                    <em class="title">${arr[0]}</em>
                  </span>
                  <span class="fc-r">${arr[1]}</span>
                </div>`
              }
            }
          } else {
            return {
              html: `<div class="fc-event-title">
                <span class="fc-l">
                  <em class="title">${arr[0]}</em>
                  </span>
                <span class="fc-r">${arr[1]}</span>
              </div>`
            }
          }
        }
      });

      fullCalendar.render();
    });
    $('.tab-btn li a').on('click', function(){
      if ($(this).text() === '주간') {
        fullCalendar.changeView('timeGridWeek');
        fullCalendar.setOption('dayMaxEvents', 999);
        $('#calendar.fc').addClass('weekGrid'); // timeGrid
        $('#calendar.fc').removeClass('monthGrid');
      } else {
        fullCalendar.changeView('dayGridMonth');
        fullCalendar.setOption('dayMaxEvents', 3);
        $('#calendar.fc').removeClass('weekGrid'); // timeGrid
        $('#calendar.fc').addClass('monthGrid');
      }
    });
    
    $(document).on('click', function(e){
      if (_showTip && !$(e.target).closest('.calendar-tooltip').length) {
        clearTimeout(_timerTip);
        _showTip = false;
        $('.calendar-tooltip').hide();
      }
    });

    var qpopup = $.urlParam('popup');
    var qsample = $.urlParam('sample');

    if (qpopup) {
      setTimeout(() => {
        if (qpopup === 'legend1') {
          // $.magnificPopup.open(getOptionsAnim('#popup-legend-1', false));
          $('a[href*="popup-legend-1"]').click();
        } else if (qpopup === 'legend2') {
          // $.magnificPopup.open(getOptionsAnim('#popup-legend-2', false));
          $('a[href*="popup-legend-1"]').click();
        }
      }, 250);
    }

    
    
    if (qsample) {
      setTimeout(() => {
        if (qsample == "weekand") {
          $('.calendar-item .tab-btn li:eq(1) a').click();
        }
      }, 250);
    }
  </script>
</body>
</html>